function updateTime(){let e=new Date,t=document.getElementById("current-time"),a=document.getElementById("current-date"),n=e.toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",timeZone:"Asia/Ho_Chi_Minh"}),i=e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});t.textContent=n,a.textContent=i}function setupPlaylist(){let e=document.querySelectorAll(".song");e.forEach(t=>{t.addEventListener("click",()=>{e.forEach(e=>e.classList.remove("active")),t.classList.add("active")})})}function switchTab(e,t){let a=document.querySelectorAll(".tab-content");a.forEach(e=>{e.classList.remove("active")});let n=document.querySelectorAll(".tab-btn");n.forEach(e=>{e.classList.remove("active")}),document.getElementById(t).classList.add("active"),e.currentTarget.classList.add("active")}function addHoverEffects(){let e=document.querySelectorAll(".profile-section, .music-player, .contact-info, .time-widget, .header, .footer");e.forEach(e=>{e.addEventListener("mouseenter",()=>{e.style.transform="translateY(-2px)",e.style.boxShadow=`
    0 0 10px rgba(100, 255, 218, 0.4),
    0 0 16px rgba(100, 255, 218, 0.25),
    0 0 24px rgba(100, 255, 218, 0.1)
  `}),e.addEventListener("mouseleave",()=>{e.style.transform="translateY(0)",e.style.boxShadow="0 0 16px rgba(100, 255, 218, 0.3)"})})}function switchTab(e,t){let a=document.querySelectorAll(".tab-content");a.forEach(e=>{e.classList.remove("active")});let n=document.querySelectorAll(".tab-btn");n.forEach(e=>{e.classList.remove("active")}),document.getElementById(t).classList.add("active"),e.currentTarget.classList.add("active")}function setupSkillInteractions(){let e=document.querySelectorAll(".skill-icon");e.forEach(e=>{e.addEventListener("click",()=>{e.style.animation="pulse 0.6s ease-in-out",setTimeout(()=>{e.style.animation=""},600)})})}const style=document.createElement("style");function checkScrollNeeded(){document.querySelectorAll(".song.active .song-title span").forEach(e=>{e.classList.remove("scrolling"),e.scrollWidth>e.parentElement.clientWidth&&e.classList.add("scrolling")})}style.textContent=`
            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.2); box-shadow: 0 0 20px rgba(100, 255, 218, 0.5); }
                100% { transform: scale(1); }
            }
        `,document.addEventListener("DOMContentLoaded",()=>{setupPlaylist(),addHoverEffects(),setupSkillInteractions(),updateTime(),setInterval(updateTime,1e3)}),document.addEventListener("DOMContentLoaded",checkScrollNeeded),window.addEventListener("resize",checkScrollNeeded);const musicData=[{id:1,title:"N\xe0ng thơ",artist:"Ho\xe0ng Dũng",duration:"4:14",url:"assets/music/nang-tho/nang-tho.mp3",image:"assets/music/nang-tho/thumbnail.webp"},{id:2,title:"Thanh xu\xe2n",artist:"Da LAB",duration:"4:01",url:"assets/music/thanh-xuan/thanh-xuan.mp3",image:"assets/music/thanh-xuan/thumbnail.webp"},{id:3,title:"V\xf9ng k\xed ức",artist:"Chillies",duration:"5:28",url:"assets/music/vung-ki-uc/vung-ki-uc.mp3",image:"assets/music/vung-ki-uc/thumbnail.webp"},{id:4,title:"Những kẻ mộng mơ",artist:"Noo Phước Thịnh",duration:"4:41",url:"assets/music/nhung-ke-mong-mo/nhung-ke-mong-mo.mp3",image:"assets/music/nhung-ke-mong-mo/thumbnail.webp"},{id:5,title:"Gh\xe9 qua",artist:"Dick x PC x Tofu",duration:"4:28",url:"assets/music/ghe-qua/ghe-qua.mp3",image:"assets/music/ghe-qua/thumbnail.webp"},],CONFIG={autoPlayFirstSong:!0};function saveRepeatMode(e){localStorage.setItem("repeatMode",e)}function loadRepeatMode(){let e=localStorage.getItem("repeatMode");return null!==e?parseInt(e,10):1}let playerState={currentSongIndex:0,isPlaying:!1,isShuffled:localStorage.getItem("isShuffled")||!1,repeatMode:loadRepeatMode(),playlist:[...musicData],played:[]};const playlist=document.getElementById("playlist"),audioPlayer=document.getElementById("audioPlayer"),playBtn=document.getElementById("playBtn"),prevBtn=document.getElementById("prevBtn"),nextBtn=document.getElementById("nextBtn"),repeatBtn=document.getElementById("repeatBtn"),progressBar=document.getElementById("progressBar"),progress=document.getElementById("progress"),currentTimeSpan=document.getElementById("currentTime"),totalTimeSpan=document.getElementById("totalTime"),shuffleBtn=document.getElementById("shuffleBtn");function updateRepeatButtonUI(e){switch(e){case 0:repeatBtn.classList.remove("active"),repeatBtn.innerHTML=`<svg>
                  <use href="assets/icons/sprite.svg#repeat"></use>
                </svg>`,repeatBtn.title="Repeat Off";break;case 1:repeatBtn.classList.add("active"),repeatBtn.innerHTML=`<svg>
                  <use href="assets/icons/sprite.svg#repeat"></use>
                </svg>`,repeatBtn.title="Repeat All";break;case 2:repeatBtn.classList.add("active"),repeatBtn.innerHTML=`<svg>
                  <use href="assets/icons/sprite.svg#repeat-one"></use>
                </svg>`,repeatBtn.title="Repeat One"}}function initPlayer(){loadPlaylist(),CONFIG.autoPlayFirstSong&&(setActiveSong(0),loadCurrentSong()),bindEvents()}function loadPlaylist(){playlist.innerHTML="",playerState.playlist.forEach((e,t)=>{let a=createSongElement(e,t);playlist.appendChild(a)})}function createSongElement(e,t){let a=document.createElement("div");return a.className="song",a.dataset.index=t,a.innerHTML=`
                <img class="song-cover" src="${e.image}" alt="${e.title}" />
                <div class="song-info">
                    <div class="song-title">
                        <span>${e.title}</span>
                    </div>
                    <div class="song-artist">${e.artist}</div>
                </div>
                `,a.addEventListener("click",()=>{t!==playerState.currentSongIndex&&(setActiveSong(t),loadCurrentSong(),play())}),a}function setActiveSong(e){document.querySelectorAll(".song").forEach(e=>{e.classList.remove("active")});let t=document.querySelector(`.song[data-index="${e}"]`);t&&t.classList.add("active"),playerState.currentSongIndex=e}function loadCurrentSong(){playerState.played.includes(playerState.currentSongIndex)||playerState.played.push(playerState.currentSongIndex);let e=getCurrentSong();e&&(audioPlayer.src=e.url,progress.style.width="0%",currentTimeSpan.textContent="0:00",totalTimeSpan.textContent=e.duration)}function getCurrentSong(){let e=playerState.currentSongIndex;return playerState.playlist[e]}function togglePlay(){playerState.isPlaying?pause():play()}function play(){audioPlayer.play(),playerState.isPlaying=!0,playBtn.innerHTML=`<svg>
                  <use href="assets/icons/sprite.svg#pause"></use>
                </svg>`}function pause(){audioPlayer.pause(),playerState.isPlaying=!1,playBtn.innerHTML=`<svg>
                  <use href="assets/icons/sprite.svg#play"></use>
                </svg>`}function randomNewSongIndex(e,t){let a;do a=Math.floor(Math.random()*t);while(e.includes(a));return a}function prevSong(){playerState.currentSongIndex>0?playerState.currentSongIndex--:playerState.currentSongIndex=playerState.playlist.length-1;let e=playerState.currentSongIndex;document.querySelectorAll(".song").forEach(e=>{e.classList.remove("active")});let t=document.querySelector(`.song[data-index="${e}"]`);t&&t.classList.add("active"),loadCurrentSong(),playerState.isPlaying?audioPlayer.play():play()}function clickNextSong(){playerState.played.length===playerState.playlist.length&&(playerState.played.length=0),playerState.currentSongIndex<playerState.playlist.length-1?playerState.currentSongIndex++:playerState.currentSongIndex=0;let e=playerState.currentSongIndex;document.querySelectorAll(".song").forEach(e=>{e.classList.remove("active")});let t=document.querySelector(`.song[data-index="${e}"]`);t&&t.classList.add("active"),loadCurrentSong(),playerState.isPlaying?audioPlayer.play():play()}function nextSong(e=!1){if(console.log(playerState.played.length),2===playerState.repeatMode){loadCurrentSong(),play();return}if(playerState.played.length===playerState.playlist.length){if(0===playerState.repeatMode){playerState.played.length=0,playerState.currentSongIndex=0;let t=playerState.currentSongIndex;document.querySelectorAll(".song").forEach(e=>{e.classList.remove("active")});let a=document.querySelector(`.song[data-index="${t}"]`);a&&a.classList.add("active"),loadCurrentSong(),pause();return}playerState.played.length=0}e?(index=playerState.currentSongIndex,playerState.currentSongIndex=randomNewSongIndex([index,...playerState.played],playerState.playlist.length)):playerState.currentSongIndex<playerState.playlist.length-1?playerState.currentSongIndex++:playerState.currentSongIndex=0;let n=playerState.currentSongIndex;document.querySelectorAll(".song").forEach(e=>{e.classList.remove("active")});let i=document.querySelector(`.song[data-index="${n}"]`);i&&i.classList.add("active"),loadCurrentSong(),playerState.isPlaying?audioPlayer.play():play()}function toggleShuffle(){playerState.isShuffled=!playerState.isShuffled,localStorage.setItem("isShuffled",playerState.isShuffled),playerState.isShuffled?shuffleBtn.classList.add("active"):shuffleBtn.classList.remove("active")}function toggleRepeat(){playerState.repeatMode=(playerState.repeatMode+1)%3,saveRepeatMode(playerState.repeatMode),updateRepeatButtonUI(playerState.repeatMode)}function formatTime(e){return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`}function bindEvents(){playBtn.addEventListener("click",togglePlay),prevBtn.addEventListener("click",prevSong),nextBtn.addEventListener("click",()=>clickNextSong()),shuffleBtn.addEventListener("click",toggleShuffle),repeatBtn.addEventListener("click",toggleRepeat),audioPlayer.addEventListener("loadedmetadata",()=>{totalTimeSpan.textContent=formatTime(audioPlayer.duration)}),audioPlayer.addEventListener("timeupdate",()=>{if(audioPlayer.duration){let e=audioPlayer.currentTime/audioPlayer.duration*100;progress.style.width=`${e}%`,currentTimeSpan.textContent=formatTime(audioPlayer.currentTime)}}),audioPlayer.addEventListener("ended",()=>{nextSong(isShuffled=playerState.isShuffled)}),progressBar.addEventListener("click",e=>{let t=progressBar.clientWidth,a=e.offsetX,n=audioPlayer.duration;audioPlayer.currentTime=a/t*n}),document.addEventListener("keydown",e=>{"Space"===e.code?(e.preventDefault(),togglePlay()):"ArrowLeft"===e.code?prevSong():"ArrowRight"===e.code&&nextSong()})}shuffleBtn.classList.add("active"),updateRepeatButtonUI(loadRepeatMode()),initPlayer();class ModernTimeWidget{constructor(){this.location=null,this.weatherData=null,this.init()}async init(){this.updateTime(),setInterval(()=>this.updateTime(),1e3),this.setDefaultLocation(),await this.getWeather(),setInterval(()=>this.getWeather(),6e5)}setDefaultLocation(){this.location={lat:21.0227346,lon:105.7956784},document.getElementById("time-widget-location").textContent="Hanoi, Vietnam"}updateTime(){let e=new Date,t=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Ho_Chi_Minh"}),a=e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});document.getElementById("current-time").textContent=t,document.getElementById("current-date").textContent=a}async getWeather(){this.location||(this.location={lat:21.0285,lon:105.8542});try{let e=`https://api.open-meteo.com/v1/forecast?latitude=${this.location.lat}&longitude=${this.location.lon}&current=temperature_2m,weather_code,wind_speed_10m&timezone=auto`,t=await fetch(e),a=await t.json();if(a.current){let n=Math.round(a.current.temperature_2m),i=a.current.weather_code,r=this.getWeatherInfo(i);document.getElementById("time-widget-temperature").textContent=`${n}\xb0C`,document.getElementById("time-widget-weather-desc").textContent=r.desc;let s=new Date().toLocaleString("en-US",{timeZone:"Asia/Ho_Chi_Minh",hour:"numeric",hour12:!1});s>=6&&s<20?document.getElementById("time-widget-weather-icon").textContent=r.icon:document.getElementById("time-widget-weather-icon").textContent=r.iconNight}else throw Error("No weather data")}catch(l){console.log("Weather fetch error:",l),this.setFallbackWeather()}}getWeatherInfo(e){return({0:{desc:"clear sky",icon:"☀️",iconNight:"\uD83C\uDF19"},1:{desc:"mainly clear",icon:"\uD83C\uDF24️",iconNight:"\uD83C\uDF19"},2:{desc:"partly cloudy",icon:"⛅",iconNight:"☁️"},3:{desc:"overcast",icon:"☁️",iconNight:"☁️"},45:{desc:"fog",icon:"\uD83C\uDF2B️",iconNight:"\uD83C\uDF2B️"},48:{desc:"depositing rime fog",icon:"\uD83C\uDF2B️",iconNight:"\uD83C\uDF2B️"},51:{desc:"light drizzle",icon:"\uD83C\uDF26️",iconNight:"\uD83C\uDF27️"},53:{desc:"moderate drizzle",icon:"\uD83C\uDF26️",iconNight:"\uD83C\uDF27️"},55:{desc:"dense drizzle",icon:"\uD83C\uDF27️",iconNight:"\uD83C\uDF27️"},61:{desc:"slight rain",icon:"\uD83C\uDF27️",iconNight:"\uD83C\uDF27️"},63:{desc:"moderate rain",icon:"\uD83C\uDF27️",iconNight:"\uD83C\uDF27️"},65:{desc:"heavy rain",icon:"⛈️",iconNight:"⛈️"},71:{desc:"slight snow",icon:"❄️",iconNight:"❄️"},73:{desc:"moderate snow",icon:"\uD83C\uDF28️",iconNight:"\uD83C\uDF28️"},75:{desc:"heavy snow",icon:"\uD83C\uDF28️",iconNight:"\uD83C\uDF28️"},80:{desc:"slight rain shower",icon:"\uD83C\uDF26️",iconNight:"\uD83C\uDF27️"},81:{desc:"moderate rain shower",icon:"\uD83C\uDF27️",iconNight:"\uD83C\uDF27️"},82:{desc:"violent rain shower",icon:"⛈️",iconNight:"⛈️"},95:{desc:"thunderstorm",icon:"⛈️",iconNight:"⛈️"},96:{desc:"thunderstorm with hail",icon:"⛈️",iconNight:"⛈️"},99:{desc:"thunderstorm with heavy hail",icon:"⛈️",iconNight:"⛈️"}})[e]||{desc:"unknown",icon:"\uD83C\uDF21️"}}setFallbackWeather(){let e=new Date().getHours(),t;t=e>=6&&e<12?{temp:26,desc:"beautiful morning",icon:"\uD83C\uDF05"}:e>=12&&e<18?{temp:32,desc:"sunny afternoon",icon:"☀️"}:e>=18&&e<21?{temp:28,desc:"pleasant evening",icon:"\uD83C\uDF07"}:{temp:24,desc:"cool night",icon:"\uD83C\uDF19"},document.getElementById("time-widget-temperature").textContent=`${t.temp}\xb0C`,document.getElementById("time-widget-weather-desc").textContent=t.desc,document.getElementById("time-widget-weather-icon").textContent=t.icon}}document.addEventListener("DOMContentLoaded",()=>{new ModernTimeWidget});class SkyCanvas{constructor(){this.canvas=document.getElementById("skyCanvas"),this.ctx=this.canvas.getContext("2d"),this.stars=[],this.particles=[],this.lastParticleSpawn=0,this.resizeCanvas(),this.createStars(),this.animate(),window.addEventListener("resize",()=>{this.resizeCanvas(),this.createStars()})}resizeCanvas(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}createStars(){this.stars=[];for(let e=0;e<100;e++)this.stars.push({x:Math.random()*this.canvas.width,y:Math.random()*this.canvas.height,size:2*Math.random(),twinkle:Math.random()*Math.PI*2,speed:3e-4+7e-4*Math.random()})}animate(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);let e=Date.now();this.stars.forEach(t=>{let a=.3+.3*Math.sin(e*t.speed+t.twinkle);this.ctx.globalAlpha=a,this.ctx.fillStyle="#ffffff",this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.size,0,2*Math.PI),this.ctx.fill()}),e-this.lastParticleSpawn>5e3&&(this.particles.push({x:Math.random()*this.canvas.width,y:this.canvas.height+20,size:2*Math.random()+1,speed:1*Math.random()+.5,opacity:.5*Math.random()+.3,age:0}),this.lastParticleSpawn=e),this.particles=this.particles.filter(e=>{e.y-=e.speed,e.age+=16;let t=1-e.age/3e4;return t>0&&e.y>-50&&(this.ctx.globalAlpha=e.opacity*t,this.ctx.fillStyle="#64ffda",this.ctx.beginPath(),this.ctx.arc(e.x,e.y,e.size*t,0,2*Math.PI),this.ctx.fill(),!0)}),this.ctx.globalAlpha=1,requestAnimationFrame(()=>this.animate())}}window.addEventListener("load",()=>{new SkyCanvas});